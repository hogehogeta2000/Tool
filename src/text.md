以下は各作業工程を詳細化し、コンサバな見積もりで開発工数（概算の人日）を算出した表の例です。なお、実装内容、環境構築、テスト、レビュー等を含む全体工程を想定しており、プロジェクトの実情に応じた調整が必要となります。

| No | タスクタイトル                                     | タスク詳細内容                                                                                                                                                                       | 開発工数 (人日) |
|----|--------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------|
| 1  | CSVファイル取込とBronze層への格納                | - rawデータ（CSV）の読み込み<br>- PySparkを用いてMicrosoft Fabricのレイクハウスに取り込み、Bronze層として格納する処理の実装                                                     | 2              |
| 2  | 複数テーブル向けカラム変換処理と中間TBL出力       | - 取り込んだrawデータに対し、5種類のカラム値変換処理（テーブル毎に実装）<br>- 変換結果をBronze層の「中間業績データTBL」として出力する処理                                             | 6              |
| 3  | 未確定データのタイムスタンプ付与＆アップサート   | - 中間業績データTBL内の未確定データに対して更新日時を付与<br>- 積み上げ業績データTBLへのアップサート処理（上書き・追加の条件分岐含む）の実装                                          | 2              |
| 4  | マスタ連携による中間TBLデータ加工処理            | - 代理店共同区分、続柄、正式名称、販売名称、代理店、担当個人番号、担当営業（営業名、所属グループ）の各マスタTBLとの連携処理<br>- 各マスタ情報を元に中間TBLへ新規列追加・更新を実施する処理 | 7              |
| 5  | 商品別ロジックに基づくデータ更新処理              | - 商品ごとに異なる業務ロジックを反映したデータ更新処理の実装                                                                                                                        | 2              |
| 6  | Silver層への確定TBL出力処理                      | - 最終的なデータを確定累積TBLおよび新契約実績TBLとしてSilver層へ格納する処理の実装                                                                                                  | 1              |

**【総計】** 約20人日（※各工程には予備工数・単体・結合テスト、運用移管対応等を含む）  

上記は保守的な見積もり例となります。詳細な要件定義やデータ量、システム環境、既存コードの状況等により実際の工数は変動する可能性があるため、初期見積もりとして参考にしてください。
