## Power QueryでPDFデータを取り込む方法

このマニュアルでは、ExcelのPower Queryを使用して、指定したPDFファイルから表データを取得し、それらを結合する方法について説明します。Power Queryは、PDFからデータを抽出する際に非常に便利なツールであり、初心者の方でも簡単に利用できます。

### 機能の概要
Power Queryを使用すると、以下のような操作が可能です：
- PDFファイル内に含まれる表データを検出して取得。
- 必要な表だけを選択して、データを抽出。
- 複数の表を1つに結合。

### 手順
以下は、PDFから表データを取得して結合する具体的な手順です：

1. **Power Queryを開く**
   1. Excelを開きます。
   2. [データ]タブをクリックし、[データの取得] -> [ファイルから] -> [PDFから]を選択します。

2. **PDFファイルを選択する**
   - 表示されるダイアログボックスで、取得したいPDFファイルの完全パスを指定します。
   - [インポート]をクリックすると、PDF内の表データが検出されます。

3. **必要なテーブルを選択する**
   - データの選択画面で、取得したい表をクリックしてプレビューを確認します。
   - 複数の表を選択する場合は、それぞれの表をチェックボックスで選択します。

4. **データを結合する**
   - 必要に応じて、Power Queryエディタ内で表を結合します。
     1. [ホーム]タブの[結合]をクリックします。
     2. 表を結合する方法を設定します（例：キー列を指定してマージ）。
   - 必要に応じて列の名前変更やフィルタリングを行います。

5. **Excelシートに読み込む**
   - 作業が完了したら、[閉じて読み込む]をクリックしてExcelシートにデータを展開します。

---

### 設定の変更方法
PDFのファイルパスやテーブルの場所が変更された場合、以下の手順で設定を変更します。

#### 1. **ファイルパスを変更する場合**
   1. [データ]タブから[クエリと接続]を開き、該当のクエリを右クリックして[編集]を選択します。
   2. Power Queryエディタが開いたら、左側の[ソース]ステップをクリックします。
   3. 右側の設定画面で、新しいPDFファイルのパスを入力します。
   4. [適用して閉じる]をクリックして変更を保存します。

#### 2. **テーブルの場所が変更された場合**
   1. [データ]タブから[クエリと接続]を開き、該当のクエリを右クリックして[編集]を選択します。
   2. Power Queryエディタで、表のプレビュー画面を確認します。
   3. 表が見つからない場合は、[ナビゲーター]画面に戻り、新しいテーブルを選択します。
   4. 必要に応じて、結合やフィルタリングの設定を調整します。
   5. [適用して閉じる]をクリックして変更を保存します。

---

### 補足
- **注意点**：PDFファイルの構造が大きく変わる場合は、再設定が必要になることがあります。
- **トラブルシューティング**：データが正しく取得できない場合、PDFファイルの形式や表の配置を確認してください。

Power Queryを活用することで、PDFファイルからのデータ取得が効率的に行えるようになります。このマニュアルを参考に、ぜひ操作をお試しください。

